---
layout: post
title: Dapper Tutorial - Part 3&colon; Simple CRUD
comments: true
categories: [ 'tutorial', 'install', 'dapper', 'micro', 'mine', 'orm', 'mssql', 'mysql' ]
lang: en-US
author: Mirche Toshevski
---
* [Dapper Tutorial - Part 1: Dapper Intro and Installation](https://neemesis.github.io/blog/2017/08/07/dapper-tutorial-1/)
* [Dapper Tutorial - Part 2: Dapper Queries](https://neemesis.github.io/blog/2017/08/08/dapper-tutorial-2/)
* [Dapper Tutorial - Part 3: Simple CRUD](https://neemesis.github.io/blog/2017/08/09/dapper-tutorial-3/)

Intro
-------
**SimpleCRUD** is class library and extension of **Dapper** writen by **[Eric Coffman](https://github.com/ericdc1)**. This extension contains 8 helper methods.
* **Get(id)** - gets one record based on the primary key
* **GetList&#x3C;Type&#x3E;()** - gets list of records all records from a table
* **GetList&#x3C;Type&#x3E;(anonymous object for where clause)** - gets list of all records matching the where options
* **GetList&#x3C;Type&#x3E;(string for conditions, anonymous object with parameters)** - gets list of all records matching the conditions
* **GetListPaged&#x3C;Type&#x3E;(int pagenumber, int itemsperpage, string for conditions, string for order, anonymous object with parameters)** - gets paged list of all records matching the conditions
* **Insert(entity)** - Inserts a record and returns the new primary key
* **Update(entity)** - Updates a record
* **Delete&#x3C;Type&#x3E;(id)** - Deletes a record based on primary key
* **Delete(entity)** - Deletes a record based on the typed entity
* **DeleteList&#x3C;Type&#x3E;(anonymous object for where clause)** - deletes all records matching the where options
* **DeleteList&#x3C;Type&#x3E;(string for conditions, anonymous object with parameters)** - deletes list of all records matching the conditions
* **RecordCount&#x3C;Type&#x3E;(string for conditions,anonymous object with parameters)** -gets count of all records matching the conditions

Installation
------
* You can either download the **SimpleCRUD.cs** file from [here](https://github.com/ericdc1/Dapper.SimpleCRUD/blob/master/Dapper.SimpleCRUD/SimpleCRUD.cs), and if you want dynamic support like **async** you need to dofnload this file also **[SimpleCRUDAsync.cs](https://github.com/ericdc1/Dapper.SimpleCRUD/blob/master/Dapper.SimpleCRUD%20NET45/SimpleCRUDAsync.cs)**.
* You can install it from **NuGet** with this command **Install-Package Dapper.SimpleCRUD** or via **NuGet Package Explorer**
![too](/assets/images/dt3_1.png 'NuGet Package Explorer')

Attributes
------
This attributes are used to modify behavior of SimpleCRUD by applying attributes to classes and properties.
* **[Table("YourTableName")]**: By default table name should be same as class name, this tag overrides this behavior
* **[Column("YourColumnName"]**: By default column name shold be same as property name, this tag overrides this behavior
* **[Key]**: By default for **Key** will be considered integer property named **Id**, but with this tag you can set any property to be Key
* **[Required]**: By default **Key** propery is not inserted and is expected to be autogenerated from DB. You can mark property with **Key** and **Required** if you want to insert non-generated **Key**
* **[Editable(false)]**: Mark properties that are computed (like FullName that is combined from FirstName and LastName) and that you want to be excluded from all **CRUD** operations
* **[ReadOnly(true)]**: Use this attribute to exclude properties from **insert** and **update**
* **[IgnoreSelect]**: Exclude property from **select**
* **[IgnoreInsert]**: Exclude property from **insert**
* **[IgnoreUpdate]**: Exclude property from **update**
* **[NotMapped]**: Excludes the property from all **CRUD** operations

Usage
------
#### Get(int id)
```csharp
var entity = Db.Get<Models.Model>(150);
```
result
```json
{"Id":150,"Name":"640I","Title":" - 640i","SViews":0,"BrandId":8,"Brand":null}
```

#### GetList()
```csharp
var entity = Db.GetList<Models.Brand>();
```
```json
[{"Id":1,"Name":"ACURA","Title":"Acura","SViews":0,"CountryId":null,"Country":null},
{"Id":2,"Name":"ALFA","Title":"Alfa Romeo","SViews":0,"CountryId":null,"Country":null},
..]
```

#### GetList(object whereConditions)
```csharp
var entity = Db.GetList<Models.Brand>(new {SViews = 10});
```
```json
[{"Id":4,"Name":"ASTON","Title":"Aston Martin","SViews":10,"CountryId":null,"Country":null},
{"Id":8,"Name":"BMW","Title":"BMW","SViews":10,"CountryId":null,"Country":null},
{"Id":43,"Name":"MCLAREN","Title":"McLaren","SViews":10,"CountryId":null,"Country":null}]
```

#### GetList(string whereConditions, object objWhereConditons = null)
```csharp
var entity = Db.GetList<Models.Brand>("where SViews = 10");
```
```json
[{"Id":1,"Name":"ACURA","Title":"Acura","SViews":0,"CountryId":null,"Country":null},
{"Id":2,"Name":"ALFA","Title":"Alfa Romeo","SViews":0,"CountryId":null,"Country":null},
..]
```

#### GetListPaged(int pageNumber, int rowsPerPage, string conditions, string orderBy,  object parameters = null)
```csharp
var entity = Db.GetListPaged<Models.Brand>(1, 5, "where Name like '%A%'", "SViews desc");
```
Select first page, with 5 results per page, filtered by name, and ordered by **SViews** in descending order. The result is:
```json
[{"Id":4,"Name":"ASTON","Title":"Aston Martin","SViews":10,"CountryId":null,"Country":null},
{"Id":43,"Name":"MCLAREN","Title":"McLaren","SViews":10,"CountryId":null,"Country":null},
{"Id":49,"Name":"NISSAN","Title":"Nissan","SViews":0,"CountryId":null,"Country":null},
{"Id":55,"Name":"RAM","Title":"RAM","SViews":0,"CountryId":null,"Country":null},
{"Id":58,"Name":"SAAB","Title":"Saab","SViews":0,"CountryId":null,"Country":null}]
```
and for the second page
```csharp
var entity = Db.GetListPaged<Models.Brand>(2, 5, "where Name like '%A%'", "SViews desc");
```
```json
[{"Id":59,"Name":"SATURN","Title":"Saturn","SViews":0,"CountryId":null,"Country":null},
{"Id":61,"Name":"SMART","Title":"smart","SViews":0,"CountryId":null,"Country":null},
{"Id":66,"Name":"TESLA","Title":"Tesla","SViews":0,"CountryId":null,"Country":null},
{"Id":67,"Name":"TOYOTA","Title":"Toyota","SViews":0,"CountryId":null,"Country":null},
{"Id":1,"Name":"ACURA","Title":"Acura","SViews":0,"CountryId":null,"Country":null}]
```

#### Insert(object entityToInsert)
```csharp
var entityId = Db.Insert(new Models.Brand { Name = "brandName", Title = "brandTitle"});
```
returns the **Id** of the newly inserted entity

#### Update(object entityToUpdate)
```csharp
var rowsAffected = Db.Update(someBrand);
```
returns number of affected rows.

#### Delete(object entityToDelete)
```csharp
var rowsAffected = Db.Delete(someBrand);
```
returns number of affected rows.

#### Delete(object whereCondition)
```csharp
var rowsAffected = Db.DeleteList<Models.Brand>(new {SViews = 0});
```
returns number of affected rows.

#### Delete(string whereCondition, object objWhereCondition = null)
```csharp
var rowsAffected = Db.DeleteList<Models.Brand>("where SViews < 5");
```
returns number of affected rows.

#### RecordCount(string whereCondition = "", object objWhereCondition = null)
```csharp
var rowsAffected = Db.RecordCount<Models.Brand>("where SViews < 5");
//or
var rowsAffected = Db.RecordCount<Models.Brand>("where SViews < @SV", new {SV = 5});
```
returns number of affected rows.

##### Source
* [SimpleCRUD on GitHub](https://github.com/ericdc1/Dapper.SimpleCRUD)